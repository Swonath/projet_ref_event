{% extends 'locataire/base_dashboard.html.twig' %}

{% block title %}Mes favoris - R√©f√©rences √âv√©nements{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/favoris.js') }}"></script>
{% endblock %}

{% block dashboard_content %}

<div class="page-header">
    <h1 class="page-title">Mes favoris ‚ù§Ô∏è</h1>
    <p class="page-subtitle">{{ favoris|length }} emplacement{% if favoris|length > 1 %}s{% endif %} en favori</p>
</div>

{% if favoris is empty %}
    <div class="empty-state">
        <div class="empty-icon">‚ù§Ô∏è</div>
        <div class="empty-title">Aucun favori</div>
        <div class="empty-text">
            Vous n'avez pas encore d'emplacement en favori.<br>
            Ajoutez-en en cliquant sur le c≈ìur ‚ù§Ô∏è sur les annonces.
        </div>
        <a href="{{ path('app_home_page') }}" class="btn-primary">
            Rechercher un emplacement
        </a>
    </div>
{% else %}
    <div class="reservations-grid">
        {% for favori in favoris %}
            {% set emplacement = favori.emplacement %}
            <div class="reservation-card" data-favori-id="{{ favori.id }}">
                <div class="reservation-image">
                    {% if emplacement.photos|length > 0 %}
                        <img src="{{ asset('uploads/photos/' ~ emplacement.photos[0].cheminFichier) }}" 
                             alt="{{ emplacement.titreAnnonce }}">
                    {% else %}
                        <div style="width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:#f5f5f5; color:#999;">
                            üì∑ Photo non disponible
                        </div>
                    {% endif %}
                    
                    {# Bouton supprimer des favoris #}
                    <button class="btn-favori btn-favori-active" 
                            data-emplacement-id="{{ emplacement.id }}"
                            onclick="toggleFavori({{ emplacement.id }}, this)"
                            title="Retirer des favoris">
                        ‚ù§Ô∏è
                    </button>
                </div>

                <div class="reservation-content">
                    <div class="reservation-header">
                        <h3 class="reservation-title">{{ emplacement.titreAnnonce }}</h3>
                        <span class="badge-disponible">
                            ‚úì Disponible
                        </span>
                    </div>

                    <div class="reservation-info">
                        <div class="reservation-location">
                            üìç {{ emplacement.centreCommercial.nomCentre }}
                        </div>
                        <div class="reservation-surface">
                            üìè {{ emplacement.surface }} m¬≤ ‚Ä¢ {{ emplacement.typeEmplacement }}
                        </div>
                        <div class="reservation-details">
                            üïê Ajout√© le {{ favori.dateAjout|date('d/m/Y √† H:i') }}
                        </div>
                    </div>

                    <div class="reservation-footer">
                        <div class="reservation-price">
                            {{ emplacement.tarifJournalier }}‚Ç¨/jour
                        </div>
                        <a href="{{ path('app_emplacement_detail', {id: emplacement.id}) }}" 
                           class="btn-secondary btn-small">
                            Voir d√©tails
                        </a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% endif %}

{% endblock %}
